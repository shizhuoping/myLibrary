# git概述

## git的特点

git是分布式版本控制系统。它主要有以下几个特点：

1、git没有明显的中央服务器，每台电脑都是一个完整的版本库，工作时无需联网，分布式使代码很安全，因为即使一台电脑坏掉，从其他人那里也可以复制（git中的中央服务器只是为了方便大家交换代码）

2、强大的分支管理、稳定性强，不会出现代码损坏的情况

3、一个版本控制系统共有的特点：只能监控文本文件的变化，二进制文件虽然也能进行版本控制，但是无法得知每次改动内容

## git安装和运行

下载windows版本，即可傻瓜式安装，安装好了之后点击开始菜单中的git bash即可输入命令。

在命令行中设置用户名和邮箱：

~~~
git config --global user.name "Your Name"
git config --global user.email "email@example.com"
~~~

# git基本操作

## 创建版本库

在想要建立版本库的文件目录内右键-git bash，然后输入：

~~~
git init
~~~

然后就建立完成了一个空的仓库，此时该目录下会出现.git目录，这里面装了git相关的设置和运行文件。

## 将文件放入版本库

首先将文件放入该目录下，然后执行：

~~~
git add 文件名
~~~

然后提交到仓库：

~~~
git commit -m "引号引起来的提交说明"
~~~

git有两个重要的概念：工作区和暂存区。工作区就是电脑中实际看到的目录，暂存区是仓库中的一个概念，实际上执行add命令会将文件从工作区存到暂存区，执行commit后所有文件会从暂存区提交到对应分支，默认是master分支，同时更新HEAD指针。

git传递的其实是修改，而不是整个文件。如果我们执行以下过程：

第一次修改 -> `git add` -> 第二次修改 -> `git commit`

会发现第二次修改是没有被提交到仓库中去的，此时可以再执行一次add，最后再commit。当然更好的方法是不要提交，而是add多次修改，最后再提交。

## 查看仓库状态

执行命令：

~~~
git status
~~~

此时就可以观察到哪些文件没有被提交到仓库，哪些被改变了。

查看提交的差异：

~~~
git diff
~~~

## 版本回退

查看提交的历史记录：

~~~
git log
~~~

此时会从上到下显示最近的一次提交到最初的提交，其中每一次有一个长长的字符串是版本号。

退回上一个版本：

~~~
git reset --hard HEAD^
~~~

退回上上个版本：

~~~
git reset --hard HEAD^^
~~~

此时仓库内的文件会恢复到之前的版本，再查看历史记录会发现最新的版本已经看不到了，因为已经被回退了，但是并没有将那个版本删除，git实际上是通过把HEAD指针指向版本链中的某个节点来完成回退的，在查看历史记录的时候也能看到当前的HEAD指针指向哪个版本。

恢复某个版本：

~~~
git reset --hard 1094a
~~~

这个恢复可以恢复到未来，也可以恢复到过去，最后是版本号的前几位，一般来说输入前几位git就能自动找到那个版本。但是回退后是无法通过历史记录命令查看失去的版本号的，此时要执行：

~~~
git reflog
~~~

这个命令会记录下所有HEAD变动的情况，以及每一个版本号，这样就能恢复版本了。

## 撤销修改

1、丢弃工作区的修改：

~~~
git checkout -- 文件名
~~~

这里有两种情况：

一种是文件自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；

一种是文件已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。

2、如果做了一些不想要的修改，然后提交到了暂存区，此时应该执行：

~~~
git reset HEAD 文件名
~~~

然后该文件就会被放回工作区，但是此时文件虽然放回了工作区，但是属于已修改状态，再用之前的丢弃工作区的修改来完成撤销即可。

3、如果commit了，可以通过版本回退来撤销

## 删除文件

如果在工作区中删除了文件，执行status命令可以看到删除信息，因为删除也是一种变化。

此时我们可以选择从库中删除该文件，执行：

~~~
git rm 文件名
~~~

然后再将修改commit即可。

我们也可以将该文件恢复到工作区，只要执行：

~~~
git checkout -- 文件名
~~~

使用这个命令时要小心，你只能将该文件恢复到最新版本，之前还未提交的修改丢失了。

可以看出checkout命令其实是用版本库里的版本替换工作区的版本。

